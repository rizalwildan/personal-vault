# BMad-Personal-Vault Fullstack Architecture Document

## Table of Contents

- [BMad-Personal-Vault Fullstack Architecture Document](#table-of-contents)
  - [Introduction](./introduction.md)
    - [Starter Template or Existing Project](./introduction.md#starter-template-or-existing-project)
    - [Change Log](./introduction.md#change-log)
  - [High Level Architecture](./high-level-architecture.md)
    - [Technical Summary](./high-level-architecture.md#technical-summary)
    - [Platform and Infrastructure Choice](./high-level-architecture.md#platform-and-infrastructure-choice)
    - [Repository Structure](./high-level-architecture.md#repository-structure)
    - [High Level Architecture Diagram](./high-level-architecture.md#high-level-architecture-diagram)
    - [Architectural Patterns](./high-level-architecture.md#architectural-patterns)
      - [Backend Patterns](./high-level-architecture.md#backend-patterns)
      - [Frontend Patterns](./high-level-architecture.md#frontend-patterns)
      - [Integration Patterns](./high-level-architecture.md#integration-patterns)
  - [Tech Stack](./tech-stack.md)
    - [Technology Stack Table](./tech-stack.md#technology-stack-table)
  - [Data Models](./data-models.md)
    - [Model: User](./data-models.md#model-user)
      - [Zod Schema](./data-models.md#zod-schema)
      - [Drizzle Schema (PostgreSQL)](./data-models.md#drizzle-schema-postgresql)
      - [Relationships](./data-models.md#relationships)
    - [Model: Note](./data-models.md#model-note)
      - [Zod Schema](./data-models.md#zod-schema)
      - [Drizzle Schema (PostgreSQL)](./data-models.md#drizzle-schema-postgresql)
      - [Relationships](./data-models.md#relationships)
    - [Model: Tag](./data-models.md#model-tag)
      - [Zod Schema](./data-models.md#zod-schema)
      - [Drizzle Schema (PostgreSQL)](./data-models.md#drizzle-schema-postgresql)
      - [Relationships](./data-models.md#relationships)
    - [Model: Session](./data-models.md#model-session)
      - [Zod Schema](./data-models.md#zod-schema)
      - [Drizzle Schema (PostgreSQL)](./data-models.md#drizzle-schema-postgresql)
      - [Relationships](./data-models.md#relationships)
    - [Complete Entity Relationship Diagram](./data-models.md#complete-entity-relationship-diagram)
    - [Database Indexes Strategy](./data-models.md#database-indexes-strategy)
  - [API Specification](./api-specification.md)
    - [Base Configuration](./api-specification.md#base-configuration)
    - [Authentication Endpoints](./api-specification.md#authentication-endpoints)
      - [POST /auth/register](./api-specification.md#post-authregister)
      - [POST /auth/login](./api-specification.md#post-authlogin)
      - [POST /auth/logout](./api-specification.md#post-authlogout)
      - [POST /auth/refresh](./api-specification.md#post-authrefresh)
    - [Note Endpoints](./api-specification.md#note-endpoints)
      - [GET /notes](./api-specification.md#get-notes)
      - [GET /notes/:id](./api-specification.md#get-notesid)
      - [POST /notes](./api-specification.md#post-notes)
      - [PATCH /notes/:id](./api-specification.md#patch-notesid)
      - [DELETE /notes/:id](./api-specification.md#delete-notesid)
      - [POST /notes/:id/reindex](./api-specification.md#post-notesidreindex)
    - [Search Endpoint](./api-specification.md#search-endpoint)
      - [POST /search](./api-specification.md#post-search)
    - [Tag Endpoints](./api-specification.md#tag-endpoints)
      - [GET /tags](./api-specification.md#get-tags)
      - [POST /tags](./api-specification.md#post-tags)
      - [PATCH /tags/:id](./api-specification.md#patch-tagsid)
      - [DELETE /tags/:id](./api-specification.md#delete-tagsid)
    - [MCP Protocol Endpoints](./api-specification.md#mcp-protocol-endpoints)
      - [POST /mcp/messages](./api-specification.md#post-mcpmessages)
      - [GET /mcp/sse](./api-specification.md#get-mcpsse)
    - [Health & Status Endpoints](./api-specification.md#health-status-endpoints)
      - [GET /health](./api-specification.md#get-health)
      - [GET /stats](./api-specification.md#get-stats)
  - [Components](./components.md)
    - [Backend Components](./components.md#backend-components)
      - [1. Authentication Service ()](./components.md#1-authentication-service)
      - [2. Notes Service ()](./components.md#2-notes-service)
      - [3. Embedding Service ()](./components.md#3-embedding-service)
      - [4. Search Service ()](./components.md#4-search-service)
      - [5. MCP Service ()](./components.md#5-mcp-service)
      - [6. Repository Layer](./components.md#6-repository-layer)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
    - [Frontend Components](./components.md#frontend-components)
      - [1. Authentication Components](./components.md#1-authentication-components)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
      - [2. Dashboard Components](./components.md#2-dashboard-components)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
      - [3. Notes Components](./components.md#3-notes-components)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
      - [4. Search Components](./components.md#4-search-components)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
      - [5. Shared Components (shadcn/ui)](./components.md#5-shared-components-shadcnui)
      - [6. Hooks](./components.md#6-hooks)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
        - [ ()](./components.md#)
  - [External APIs](./external-apis.md)
    - [None (Fully Offline)](./external-apis.md#none-fully-offline)
  - [Core Workflows](./core-workflows.md)
    - [1. User Registration Flow](./core-workflows.md#1-user-registration-flow)
    - [2. Create Note with Embedding Flow](./core-workflows.md#2-create-note-with-embedding-flow)
    - [3. Semantic Search Flow](./core-workflows.md#3-semantic-search-flow)
    - [4. MCP Integration Flow](./core-workflows.md#4-mcp-integration-flow)
    - [5. JWT Token Refresh Flow](./core-workflows.md#5-jwt-token-refresh-flow)
    - [6. Manual Re-indexing Flow](./core-workflows.md#6-manual-re-indexing-flow)
  - [Database Schema](./database-schema.md)
    - [Prerequisites](./database-schema.md#prerequisites)
    - [Tables](./database-schema.md#tables)
      - [users](./database-schema.md#users)
      - [notes](./database-schema.md#notes)
      - [tags](./database-schema.md#tags)
      - [sessions](./database-schema.md#sessions)
    - [Database Size Estimation](./database-schema.md#database-size-estimation)
    - [Drizzle ORM Schema Files](./database-schema.md#drizzle-orm-schema-files)
    - [Migration Strategy](./database-schema.md#migration-strategy)
  - [Frontend Architecture](./frontend-architecture.md)
    - [Technology Stack](./frontend-architecture.md#technology-stack)
    - [Directory Structure](./frontend-architecture.md#directory-structure)
    - [Routing Strategy](./frontend-architecture.md#routing-strategy)
    - [State Management](./frontend-architecture.md#state-management)
      - [Authentication State](./frontend-architecture.md#authentication-state)
      - [Server State (Notes, Tags)](./frontend-architecture.md#server-state-notes-tags)
    - [API Integration](./frontend-architecture.md#api-integration)
    - [Performance Optimizations](./frontend-architecture.md#performance-optimizations)
    - [Accessibility](./frontend-architecture.md#accessibility)
  - [Backend Architecture](./backend-architecture.md)
    - [Technology Stack](./backend-architecture.md#technology-stack)
    - [Directory Structure](./backend-architecture.md#directory-structure)
    - [Application Entry Point](./backend-architecture.md#application-entry-point)
    - [Elysia App Configuration](./backend-architecture.md#elysia-app-configuration)
    - [Authentication Middleware](./backend-architecture.md#authentication-middleware)
    - [Route Example: Notes](./backend-architecture.md#route-example-notes)
    - [Service Layer: Embedding Service](./backend-architecture.md#service-layer-embedding-service)
    - [Background Job Queue](./backend-architecture.md#background-job-queue)
    - [MCP Protocol Implementation](./backend-architecture.md#mcp-protocol-implementation)
    - [Error Handling](./backend-architecture.md#error-handling)
  - [Unified Project Structure](./unified-project-structure.md)
    - [Workspace Configuration](./unified-project-structure.md#workspace-configuration)
  - [Development Workflow](./development-workflow.md)
    - [Local Development Setup](./development-workflow.md#local-development-setup)
    - [Docker Compose (Development)](./development-workflow.md#docker-compose-development)
    - [Git Workflow](./development-workflow.md#git-workflow)
  - [Deployment Architecture](./deployment-architecture.md)
    - [Production Stack](./deployment-architecture.md#production-stack)
    - [Docker Production Build](./deployment-architecture.md#docker-production-build)
    - [Docker Compose Production](./deployment-architecture.md#docker-compose-production)
    - [Nginx Configuration](./deployment-architecture.md#nginx-configuration)
    - [Deployment Checklist](./deployment-architecture.md#deployment-checklist)
  - [Security and Performance](./security-and-performance.md)
    - [Security Measures](./security-and-performance.md#security-measures)
    - [Performance Optimizations](./security-and-performance.md#performance-optimizations)
  - [Testing Strategy](./testing-strategy.md)
    - [Testing Pyramid](./testing-strategy.md#testing-pyramid)
    - [Frontend Testing](./testing-strategy.md#frontend-testing)
    - [Backend Testing](./testing-strategy.md#backend-testing)
    - [Test Coverage Requirements](./testing-strategy.md#test-coverage-requirements)
  - [Coding Standards](./coding-standards.md)
    - [TypeScript Configuration](./coding-standards.md#typescript-configuration)
    - [ESLint Rules](./coding-standards.md#eslint-rules)
    - [Naming Conventions](./coding-standards.md#naming-conventions)
    - [Code Organization](./coding-standards.md#code-organization)
    - [Documentation Standards](./coding-standards.md#documentation-standards)
  - [Error Handling Strategy](./error-handling-strategy.md)
    - [Frontend Error Handling](./error-handling-strategy.md#frontend-error-handling)
    - [Backend Error Handling](./error-handling-strategy.md#backend-error-handling)
    - [Logging Strategy](./error-handling-strategy.md#logging-strategy)
  - [Monitoring and Observability](./monitoring-and-observability.md)
    - [Health Checks](./monitoring-and-observability.md#health-checks)
    - [Metrics to Monitor](./monitoring-and-observability.md#metrics-to-monitor)
    - [Future: Observability Stack (v2.0+)](./monitoring-and-observability.md#future-observability-stack-v20)
  - [Checklist Results](./checklist-results.md)
